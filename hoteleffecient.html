<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hotel Revenue Tracker & Forecasting Template</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .content {
            padding: 30px;
        }

        .section {
            margin-bottom: 40px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            overflow: hidden;
        }

        .section-header {
            background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%);
            color: white;
            padding: 20px;
            font-size: 1.3em;
            font-weight: 600;
        }

        .table-container {
            overflow-x: auto;
            padding: 20px;
            max-width: 100%;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }

        th, td {
            padding: 12px 8px;
            text-align: center;
            border: 1px solid #e0e0e0;
            min-width: 120px;
            white-space: nowrap;
        }

        th {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            font-weight: 600;
            color: #2c3e50;
            text-transform: uppercase;
            font-size: 11px;
            letter-spacing: 0.5px;
        }

        .month-header {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white !important;
            font-size: 12px;
        }

        .input-cell {
            background: #f8f9ff;
        }

        .input-cell input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-align: center;
            font-size: 13px;
            background: white;
            transition: all 0.3s ease;
            min-width: 120px;
        }

        .input-cell input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 5px rgba(52, 152, 219, 0.3);
        }

        .calculated-cell {
            background: #e8f5e8;
            font-weight: 600;
            color: #27ae60;
        }

        .forecast-cell {
            background: #fff3cd;
            font-weight: 600;
            color: #856404;
        }

        .variance-positive {
            background: #d1edcc;
            color: #155724;
            font-weight: 600;
        }

        .variance-negative {
            background: #f8d7da;
            color: #721c24;
            font-weight: 600;
        }

        .total-row {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            font-weight: bold;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            padding: 20px;
        }

        .metric-card {
            background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
        }

        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .metric-value {
            font-size: 2em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .metric-label {
            color: #7f8c8d;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .instructions {
            background: linear-gradient(135deg, #e8f5e8 0%, #d1edcc 100%);
            border-left: 5px solid #27ae60;
            padding: 20px;
            margin-bottom: 30px;
            border-radius: 0 10px 10px 0;
        }

        .instructions h3 {
            color: #27ae60;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .instructions ul {
            list-style-type: none;
            padding-left: 0;
        }

        .instructions li {
            margin-bottom: 8px;
            padding-left: 20px;
            position: relative;
        }

        .instructions li:before {
            content: "‚úì";
            color: #27ae60;
            font-weight: bold;
            position: absolute;
            left: 0;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }
           
            .content {
                padding: 15px;
            }
           
            th, td {
                padding: 8px 4px;
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üè® Hotel Revenue Tracker & Forecasting</h1>
            <p>Comprehensive Revenue Analysis & Forecasting Template</p>
        </div>

        <div class="content">
            <div class="instructions">
                <h3>How to Use This Template</h3>
                <ul>
                    <li>Fill in the blue input cells with your actual revenue data</li>
                    <li>Previous year data helps establish baseline trends</li>
                    <li>Current year actuals should be entered as you have them</li>
                    <li>Forecasting will automatically calculate based on trends and seasonality</li>
                    <li>Green cells show calculated values and totals</li>
                    <li>Yellow cells show forecasted values</li>
                    <li>Variance analysis shows performance vs previous year</li>
                </ul>
            </div>

            <div class="section">
                <div class="section-header">
                    üìä Monthly Revenue Data & Forecasting
                </div>
                <div class="table-container">
                    <table id="revenueTable">
                        <thead>
                            <tr>
                                <th>Metric</th>
                                <th class="month-header">Jan</th>
                                <th class="month-header">Feb</th>
                                <th class="month-header">Mar</th>
                                <th class="month-header">Apr</th>
                                <th class="month-header">May</th>
                                <th class="month-header">Jun</th>
                                <th class="month-header">Jul</th>
                                <th class="month-header">Aug</th>
                                <th class="month-header">Sep</th>
                                <th class="month-header">Oct</th>
                                <th class="month-header">Nov</th>
                                <th class="month-header">Dec</th>
                                <th class="total-row">Total</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th>Previous Year Revenue</th>
                                <td class="input-cell"><input type="number" placeholder="0" oninput="calculateAll()"></td>
                                <td class="input-cell"><input type="number" placeholder="0" oninput="calculateAll()"></td>
                                <td class="input-cell"><input type="number" placeholder="0" oninput="calculateAll()"></td>
                                <td class="input-cell"><input type="number" placeholder="0" oninput="calculateAll()"></td>
                                <td class="input-cell"><input type="number" placeholder="0" oninput="calculateAll()"></td>
                                <td class="input-cell"><input type="number" placeholder="0" oninput="calculateAll()"></td>
                                <td class="input-cell"><input type="number" placeholder="0" oninput="calculateAll()"></td>
                                <td class="input-cell"><input type="number" placeholder="0" oninput="calculateAll()"></td>
                                <td class="input-cell"><input type="number" placeholder="0" oninput="calculateAll()"></td>
                                <td class="input-cell"><input type="number" placeholder="0" oninput="calculateAll()"></td>
                                <td class="input-cell"><input type="number" placeholder="0" oninput="calculateAll()"></td>
                                <td class="input-cell"><input type="number" placeholder="0" oninput="calculateAll()"></td>
                                <td class="calculated-cell" id="prevTotal">$0</td>
                            </tr>
                            <tr>
                                <th>Current Year Actual</th>
                                <td class="input-cell"><input type="number" placeholder="0" oninput="calculateAll()"></td>
                                <td class="input-cell"><input type="number" placeholder="0" oninput="calculateAll()"></td>
                                <td class="input-cell"><input type="number" placeholder="0" oninput="calculateAll()"></td>
                                <td class="input-cell"><input type="number" placeholder="0" oninput="calculateAll()"></td>
                                <td class="input-cell"><input type="number" placeholder="0" oninput="calculateAll()"></td>
                                <td class="input-cell"><input type="number" placeholder="0" oninput="calculateAll()"></td>
                                <td class="input-cell"><input type="number" placeholder="0" oninput="calculateAll()"></td>
                                <td class="forecast-cell" id="aug-forecast">Forecast</td>
                                <td class="forecast-cell" id="sep-forecast">Forecast</td>
                                <td class="forecast-cell" id="oct-forecast">Forecast</td>
                                <td class="forecast-cell" id="nov-forecast">Forecast</td>
                                <td class="forecast-cell" id="dec-forecast">Forecast</td>
                                <td class="calculated-cell" id="currentTotal">$0</td>
                            </tr>
                            <tr>
                                <th>Variance ($)</th>
                                <td class="calculated-cell" id="var1">$0</td>
                                <td class="calculated-cell" id="var2">$0</td>
                                <td class="calculated-cell" id="var3">$0</td>
                                <td class="calculated-cell" id="var4">$0</td>
                                <td class="calculated-cell" id="var5">$0</td>
                                <td class="calculated-cell" id="var6">$0</td>
                                <td class="calculated-cell" id="var7">$0</td>
                                <td class="calculated-cell" id="var8">$0</td>
                                <td class="calculated-cell" id="var9">$0</td>
                                <td class="calculated-cell" id="var10">$0</td>
                                <td class="calculated-cell" id="var11">$0</td>
                                <td class="calculated-cell" id="var12">$0</td>
                                <td class="calculated-cell" id="varTotal">$0</td>
                            </tr>
                            <tr>
                                <th>Variance (%)</th>
                                <td class="calculated-cell" id="varPct1">0%</td>
                                <td class="calculated-cell" id="varPct2">0%</td>
                                <td class="calculated-cell" id="varPct3">0%</td>
                                <td class="calculated-cell" id="varPct4">0%</td>
                                <td class="calculated-cell" id="varPct5">0%</td>
                                <td class="calculated-cell" id="varPct6">0%</td>
                                <td class="calculated-cell" id="varPct7">0%</td>
                                <td class="calculated-cell" id="varPct8">0%</td>
                                <td class="calculated-cell" id="varPct9">0%</td>
                                <td class="calculated-cell" id="varPct10">0%</td>
                                <td class="calculated-cell" id="varPct11">0%</td>
                                <td class="calculated-cell" id="varPct12">0%</td>
                                <td class="calculated-cell" id="varPctTotal">0%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    üìÖ Daily Revenue Analysis
                </div>
                <div style="padding: 20px;">
                    <div style="display: flex; align-items: center; gap: 20px; margin-bottom: 20px; flex-wrap: wrap;">
                        <div>
                            <label style="font-weight: 600; color: #2c3e50; margin-right: 10px;">Select Month:</label>
                            <select id="dailyMonth" onchange="updateDailyView()" style="padding: 8px 12px; border: 2px solid #3498db; border-radius: 6px; font-size: 14px; background: white;">
                                <option value="0">January</option>
                                <option value="1">February</option>
                                <option value="2">March</option>
                                <option value="3">April</option>
                                <option value="4">May</option>
                                <option value="5">June</option>
                                <option value="6">July</option>
                                <option value="7">August</option>
                                <option value="8">September</option>
                                <option value="9">October</option>
                                <option value="10">November</option>
                                <option value="11">December</option>
                            </select>
                        </div>
                        <div class="metric-card" style="margin: 0; min-width: 180px;">
                            <div class="metric-value" style="font-size: 1.3em;" id="monthlyTarget">$0</div>
                            <div class="metric-label">Monthly Target</div>
                        </div>
                        <div class="metric-card" style="margin: 0; min-width: 180px;">
                            <div class="metric-value" style="font-size: 1.3em;" id="dailyProgress">$0</div>
                            <div class="metric-label">Daily Progress</div>
                        </div>
                    </div>
                   
                    <div class="table-container" style="max-height: 500px; overflow-y: auto;">
                        <table id="dailyTable">
                            <thead style="position: sticky; top: 0; z-index: 10;">
                                <tr>
                                    <th rowspan="2">Day</th>
                                    <th colspan="4" style="background: #e74c3c; color: white;">Previous Year Actual</th>
                                    <th colspan="4" style="background: #9b59b6; color: white;">Manager Forecast</th>
                                    <th colspan="4" style="background: #27ae60; color: white;">Current Year Actual</th>
                                    <th rowspan="2" style="background: #3498db; color: white;">Accuracy Score</th>
                                </tr>
                                <tr>
                                    <th style="background: #c0392b; color: white; font-size: 10px;">Revenue</th>
                                    <th style="background: #a93226; color: white; font-size: 10px;">ADR</th>
                                    <th style="background: #922b21; color: white; font-size: 10px;">Occ %</th>
                                    <th style="background: #7b241c; color: white; font-size: 10px;">RevPAR</th>
                                    <th style="background: #8e44ad; color: white; font-size: 10px;">Revenue</th>
                                    <th style="background: #7d3c98; color: white; font-size: 10px;">ADR</th>
                                    <th style="background: #6c3483; color: white; font-size: 10px;">Occ %</th>
                                    <th style="background: #5b2c6f; color: white; font-size: 10px;">RevPAR</th>
                                    <th style="background: #239b56; color: white; font-size: 10px;">Revenue</th>
                                    <th style="background: #1e8449; color: white; font-size: 10px;">ADR</th>
                                    <th style="background: #196f3d; color: white; font-size: 10px;">Occ %</th>
                                    <th style="background: #145a32; color: white; font-size: 10px;">RevPAR</th>
                                </tr>
                            </thead>
                            <tbody id="dailyTableBody">
                                <!-- Daily rows will be generated here -->
                            </tbody>
                        </table>
                    </div>
                   
                    <div style="margin-top: 20px; display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px;">
                        <div class="metric-card">
                            <div class="metric-value" id="avgDailyRev">$0</div>
                            <div class="metric-label">Avg Daily Revenue</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" id="avgADR">$0</div>
                            <div class="metric-label">Average ADR</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" id="avgOcc">0%</div>
                            <div class="metric-label">Average Occupancy</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" id="avgRevPAR">$0</div>
                            <div class="metric-label">Average RevPAR</div>
                        </div>
                        <div class="metric-card" style="background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%); color: white;">
                            <div class="metric-value" id="forecastAccuracyDaily" style="color: white;">0%</div>
                            <div class="metric-label" style="color: #f8f9fa;">Manager Forecast Accuracy</div>
                        </div>
                        <div class="metric-card" style="background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%); color: white;">
                            <div class="metric-value" id="varianceVsPrevYear" style="color: white;">0%</div>
                            <div class="metric-label" style="color: #f8f9fa;">Variance vs Prev Year</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    üìà Key Performance Metrics
                </div>
                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-value" id="avgMonthly">$0</div>
                        <div class="metric-label">Avg Monthly Revenue</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="yoyGrowth">0%</div>
                        <div class="metric-label">YoY Growth Rate</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="forecastAccuracy">0%</div>
                        <div class="metric-label">Forecast vs Actual</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="runRate">$0</div>
                        <div class="metric-label">Annual Run Rate</div>
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    üéØ Forecasting Parameters
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Value</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Growth Rate</strong></td>
                                <td class="input-cell"><input type="number" id="growthRate" value="5" step="0.1" oninput="calculateAll()">%</td>
                                <td>Expected annual growth rate for forecasting</td>
                            </tr>
                            <tr>
                                <td><strong>Seasonality Factor</strong></td>
                                <td class="input-cell"><input type="number" id="seasonality" value="1.1" step="0.1" oninput="calculateAll()"></td>
                                <td>Seasonal adjustment multiplier (1.0 = no adjustment)</td>
                            </tr>
                            <tr>
                                <td><strong>Current Month</strong></td>
                                <td class="input-cell">
                                    <select id="currentMonth" onchange="calculateAll()">
                                        <option value="0">January</option>
                                        <option value="1">February</option>
                                        <option value="2">March</option>
                                        <option value="3">April</option>
                                        <option value="4">May</option>
                                        <option value="5">June</option>
                                        <option value="6">July</option>
                                        <option value="7" selected>August</option>
                                        <option value="8">September</option>
                                        <option value="9">October</option>
                                        <option value="10">November</option>
                                        <option value="11">December</option>
                                    </select>
                                </td>
                                <td>Current month (affects forecasting start point)</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        function formatCurrency(amount) {
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(amount || 0);
        }

        function formatPercentage(value) {
            return (value || 0).toFixed(1) + '%';
        }

        function updateDailyView() {
            const selectedMonth = parseInt(document.getElementById('dailyMonth').value);
            const monthNames = ['January', 'February', 'March', 'April', 'May', 'June',
                              'July', 'August', 'September', 'October', 'November', 'December'];
            const daysInMonth = new Date(2024, selectedMonth + 1, 0).getDate();
           
            // Get monthly targets from main table
            const table = document.getElementById('revenueTable');
            const prevYearInputs = table.querySelectorAll('tbody tr:nth-child(1) input');
            const currentYearInputs = table.querySelectorAll('tbody tr:nth-child(2) input');
           
            const prevYearMonthly = parseFloat(prevYearInputs[selectedMonth].value) || 0;
            let currentYearMonthly = 0;
           
            if (selectedMonth < 7) {
                currentYearMonthly = parseFloat(currentYearInputs[selectedMonth].value) || 0;
            } else {
                // Get forecasted value
                const forecastCells = ['aug-forecast', 'sep-forecast', 'oct-forecast', 'nov-forecast', 'dec-forecast'];
                if (selectedMonth >= 7 && selectedMonth <= 11) {
                    const forecastCell = document.getElementById(forecastCells[selectedMonth - 7]);
                    const forecastText = forecastCell.textContent.replace(/[$,]/g, '');
                    currentYearMonthly = parseFloat(forecastText) || 0;
                }
            }
           
            document.getElementById('monthlyTarget').textContent = formatCurrency(currentYearMonthly);
           
            // Generate daily table
            const tbody = document.getElementById('dailyTableBody');
            tbody.innerHTML = '';
           
            for (let day = 1; day <= daysInMonth; day++) {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td style="font-weight: 600; background: #f8f9fa; font-size: 13px;">${day}</td>
                    <td class="input-cell"><input type="number" placeholder="0" style="min-width: 90px; font-size: 12px;" oninput="calculateDailyMetrics()"></td>
                    <td class="input-cell"><input type="number" placeholder="0" step="0.01" style="min-width: 80px; font-size: 12px;" oninput="calculateDailyMetrics()"></td>
                    <td class="input-cell"><input type="number" placeholder="0" step="0.1" max="100" style="min-width: 60px; font-size: 12px;" oninput="calculateDailyMetrics()"></td>
                    <td class="calculated-cell" style="background: #fdf2e9; font-size: 12px; min-width: 80px;">$0</td>
                    <td class="input-cell" style="background: #f4f0ff;"><input type="number" placeholder="0" style="min-width: 90px; font-size: 12px; background: #f4f0ff;" oninput="calculateDailyMetrics()"></td>
                    <td class="input-cell" style="background: #f4f0ff;"><input type="number" placeholder="0" step="0.01" style="min-width: 80px; font-size: 12px; background: #f4f0ff;" oninput="calculateDailyMetrics()"></td>
                    <td class="input-cell" style="background: #f4f0ff;"><input type="number" placeholder="0" step="0.1" max="100" style="min-width: 60px; font-size: 12px; background: #f4f0ff;" oninput="calculateDailyMetrics()"></td>
                    <td class="calculated-cell" style="background: #f0e6ff; font-size: 12px; min-width: 80px;">$0</td>
                    <td class="input-cell"><input type="number" placeholder="0" style="min-width: 90px; font-size: 12px;" oninput="calculateDailyMetrics()"></td>
                    <td class="input-cell"><input type="number" placeholder="0" step="0.01" style="min-width: 80px; font-size: 12px;" oninput="calculateDailyMetrics()"></td>
                    <td class="input-cell"><input type="number" placeholder="0" step="0.1" max="100" style="min-width: 60px; font-size: 12px;" oninput="calculateDailyMetrics()"></td>
                    <td class="calculated-cell" style="background: #e8f8f5; font-size: 12px; min-width: 80px;">$0</td>
                    <td class="calculated-cell" style="background: #e3f2fd; font-size: 12px; min-width: 80px; font-weight: 600;">0%</td>
                `;
                tbody.appendChild(row);
            }
           
            calculateDailyMetrics();
        }
       
        function calculateDailyMetrics() {
            const tbody = document.getElementById('dailyTableBody');
            const rows = tbody.querySelectorAll('tr');
           
            let totalPrevRevenue = 0;
            let totalCurrentRevenue = 0;
            let totalForecastRevenue = 0;
            let totalPrevADR = 0;
            let totalCurrentADR = 0;
            let totalForecastADR = 0;
            let totalPrevOcc = 0;
            let totalCurrentOcc = 0;
            let totalForecastOcc = 0;
            let daysWithData = 0;
            let accuracyScores = [];
           
            rows.forEach((row, index) => {
                const inputs = row.querySelectorAll('input');
                const cells = row.querySelectorAll('td');
               
                // Get values - Previous Year
                const prevRev = parseFloat(inputs[0].value) || 0;
                const prevADR = parseFloat(inputs[1].value) || 0;
                const prevOcc = parseFloat(inputs[2].value) || 0;
               
                // Manager Forecast
                const forecastRev = parseFloat(inputs[3].value) || 0;
                const forecastADR = parseFloat(inputs[4].value) || 0;
                const forecastOcc = parseFloat(inputs[5].value) || 0;
               
                // Current Year Actual
                const currentRev = parseFloat(inputs[6].value) || 0;
                const currentADR = parseFloat(inputs[7].value) || 0;
                const currentOcc = parseFloat(inputs[8].value) || 0;
               
                // Calculate RevPAR for all three categories
                const prevRevPAR = prevADR * (prevOcc / 100);
                const forecastRevPAR = forecastADR * (forecastOcc / 100);
                const currentRevPAR = currentADR * (currentOcc / 100);
               
                // Update RevPAR cells (indices 4, 8, 12)
                cells[4].textContent = formatCurrency(prevRevPAR);
                cells[8].textContent = formatCurrency(forecastRevPAR);
                cells[12].textContent = formatCurrency(currentRevPAR);
               
                // Calculate accuracy score (comparing forecast vs actual)
                let accuracyScore = 0;
                if (forecastRev > 0 && currentRev > 0) {
                    const revenueAccuracy = 100 - Math.abs((forecastRev - currentRev) / currentRev * 100);
                    const adrAccuracy = forecastADR > 0 && currentADR > 0 ?
                        100 - Math.abs((forecastADR - currentADR) / currentADR * 100) : 0;
                    const occAccuracy = forecastOcc > 0 && currentOcc > 0 ?
                        100 - Math.abs((forecastOcc - currentOcc) / currentOcc * 100) : 0;
                   
                    // Weight revenue accuracy more heavily (50%), ADR and Occ 25% each
                    accuracyScore = (revenueAccuracy * 0.5) + (adrAccuracy * 0.25) + (occAccuracy * 0.25);
                    accuracyScore = Math.max(0, Math.min(100, accuracyScore)); // Keep between 0-100
                    accuracyScores.push(accuracyScore);
                }
               
                // Update accuracy cell (index 13)
                cells[13].textContent = accuracyScore > 0 ? formatPercentage(accuracyScore) : '-';
               
                // Color code accuracy
                if (accuracyScore >= 90) {
                    cells[13].style.background = '#d1edcc';
                    cells[13].style.color = '#155724';
                } else if (accuracyScore >= 75) {
                    cells[13].style.background = '#fff3cd';
                    cells[13].style.color = '#856404';
                } else if (accuracyScore > 0) {
                    cells[13].style.background = '#f8d7da';
                    cells[13].style.color = '#721c24';
                } else {
                    cells[13].style.background = '#e3f2fd';
                    cells[13].style.color = '#1565c0';
                }
               
                // Accumulate totals
                totalPrevRevenue += prevRev;
                totalCurrentRevenue += currentRev;
                totalForecastRevenue += forecastRev;
                totalPrevADR += prevADR;
                totalCurrentADR += currentADR;
                totalForecastADR += forecastADR;
                totalPrevOcc += prevOcc;
                totalCurrentOcc += currentOcc;
                totalForecastOcc += forecastOcc;
               
                if (prevRev > 0 || currentRev > 0 || forecastRev > 0) daysWithData++;
            });
           
            // Update daily progress
            document.getElementById('dailyProgress').textContent = formatCurrency(totalCurrentRevenue);
           
            // Update averages
            const avgDays = Math.max(daysWithData, 1);
            document.getElementById('avgDailyRev').textContent = formatCurrency(totalCurrentRevenue / rows.length);
            document.getElementById('avgADR').textContent = formatCurrency(totalCurrentADR / avgDays);
            document.getElementById('avgOcc').textContent = formatPercentage(totalCurrentOcc / avgDays);
           
            const avgRevPAR = (totalCurrentADR / avgDays) * (totalCurrentOcc / avgDays / 100);
            document.getElementById('avgRevPAR').textContent = formatCurrency(avgRevPAR);
           
            // Calculate overall forecast accuracy
            const overallAccuracy = accuracyScores.length > 0 ?
                accuracyScores.reduce((a, b) => a + b, 0) / accuracyScores.length : 0;
            document.getElementById('forecastAccuracyDaily').textContent = formatPercentage(overallAccuracy);
           
            // Calculate variance vs previous year
            const varianceVsPrev = totalPrevRevenue > 0 ?
                ((totalCurrentRevenue - totalPrevRevenue) / totalPrevRevenue * 100) : 0;
            document.getElementById('varianceVsPrevYear').textContent = formatPercentage(varianceVsPrev);
        }
       
        function calculateAll() {
            const table = document.getElementById('revenueTable');
            const prevYearInputs = table.querySelectorAll('tbody tr:nth-child(1) input');
            const currentYearInputs = table.querySelectorAll('tbody tr:nth-child(2) input');
           
            let prevYearData = [];
            let currentYearData = [];
           
            // Get previous year data
            prevYearInputs.forEach((input, index) => {
                prevYearData[index] = parseFloat(input.value) || 0;
            });
           
            // Get current year data (only first 7 months are inputs)
            for (let i = 0; i < 7; i++) {
                currentYearData[i] = parseFloat(currentYearInputs[i].value) || 0;
            }
           
            // Calculate forecasts for remaining months
            const growthRate = parseFloat(document.getElementById('growthRate').value) || 5;
            const seasonality = parseFloat(document.getElementById('seasonality').value) || 1.1;
            const currentMonth = parseInt(document.getElementById('currentMonth').value) || 7;
           
            // Forecast remaining months based on previous year + growth + seasonality
            for (let i = 7; i < 12; i++) {
                if (prevYearData[i] > 0) {
                    const baseAmount = prevYearData[i] * (1 + growthRate / 100);
                    const seasonalAdjustment = i >= 8 && i <= 10 ? seasonality : 1; // Fall season boost
                    currentYearData[i] = baseAmount * seasonalAdjustment;
                } else {
                    // If no previous year data, use average of available current year data
                    const avgCurrent = currentYearData.slice(0, 7).reduce((a, b) => a + b, 0) / 7;
                    currentYearData[i] = avgCurrent * (1 + growthRate / 100);
                }
            }
           
            // Update forecast cells
            for (let i = 7; i < 12; i++) {
                const forecastCell = document.getElementById(['aug-forecast', 'sep-forecast', 'oct-forecast', 'nov-forecast', 'dec-forecast'][i - 7]);
                forecastCell.textContent = formatCurrency(currentYearData[i]);
            }
           
            // Calculate totals
            const prevTotal = prevYearData.reduce((a, b) => a + b, 0);
            const currentTotal = currentYearData.reduce((a, b) => a + b, 0);
           
            document.getElementById('prevTotal').textContent = formatCurrency(prevTotal);
            document.getElementById('currentTotal').textContent = formatCurrency(currentTotal);
           
            // Calculate variances
            for (let i = 0; i < 12; i++) {
                const variance = currentYearData[i] - prevYearData[i];
                const variancePct = prevYearData[i] > 0 ? (variance / prevYearData[i]) * 100 : 0;
               
                const varCell = document.getElementById(`var${i + 1}`);
                const varPctCell = document.getElementById(`varPct${i + 1}`);
               
                varCell.textContent = formatCurrency(variance);
                varPctCell.textContent = formatPercentage(variancePct);
               
                // Color coding for variance
                if (variance > 0) {
                    varCell.className = 'variance-positive';
                    varPctCell.className = 'variance-positive';
                } else if (variance < 0) {
                    varCell.className = 'variance-negative';
                    varPctCell.className = 'variance-negative';
                } else {
                    varCell.className = 'calculated-cell';
                    varPctCell.className = 'calculated-cell';
                }
            }
           
            // Total variance
            const totalVariance = currentTotal - prevTotal;
            const totalVariancePct = prevTotal > 0 ? (totalVariance / prevTotal) * 100 : 0;
           
            document.getElementById('varTotal').textContent = formatCurrency(totalVariance);
            document.getElementById('varPctTotal').textContent = formatPercentage(totalVariancePct);
           
            // Update metrics
            document.getElementById('avgMonthly').textContent = formatCurrency(currentTotal / 12);
            document.getElementById('yoyGrowth').textContent = formatPercentage(totalVariancePct);
           
            // Calculate run rate based on current month
            const actualMonths = currentMonth + 1;
            const actualRevenue = currentYearData.slice(0, actualMonths).reduce((a, b) => a + b, 0);
            const runRate = actualRevenue > 0 ? (actualRevenue / actualMonths) * 12 : 0;
            document.getElementById('runRate').textContent = formatCurrency(runRate);
           
            // Forecast accuracy (simple metric based on variance)
            const accuracy = Math.max(0, 100 - Math.abs(totalVariancePct));
            document.getElementById('forecastAccuracy').textContent = formatPercentage(accuracy);
        }
       
        // Initialize calculations
        calculateAll();
        updateDailyView();
    </script>
</body>
</html>
